<!DOCTYPE html><html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¢…èŠ±å¿ƒæ˜“ï½œå å¦ç­†è¨˜</title>
  <style>
    body { font-family: "Microsoft JhengHei", sans-serif; margin: 20px; background: #f7f7f7; }
    h1 { text-align: center; color: #333; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background: #eee; }
    textarea { width: 100%; height: 50px; }
    select, input { width: 95%; padding: 5px; }
    .controls { margin-top: 20px; text-align: center; }
    button { margin: 5px; padding: 8px 15px; }
    .summary { margin-top: 30px; padding: 15px; background: #fff; border: 1px solid #ccc; }
    .explain { color: #666; font-size: 0.9em; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>æ¢…èŠ±å¿ƒæ˜“ï½œå å¦ç­†è¨˜</h1>  <table>
    <thead>
      <tr>
        <th>å¦ä½å±¤æ¬¡</th>
        <th>é«”</th>
        <th>ç”¨/äº’/è®Š</th>
        <th>äº”è¡Œé—œä¿‚ä»£è™Ÿ</th>
        <th>åˆ¤æ–·ç°¡è¦</th>
      </tr>
    </thead>
    <tbody id="records">
      <tr>
        <td>æœ¬å¦</td>
        <td><input></td>
        <td><input></td>
        <td>
          <select onchange="showExplain(this)">
            <option value="">é¸æ“‡</option>
            <option>WS</option>
            <option>WK</option>
            <option>SS</option>
            <option>SK</option>
            <option>BH</option>
          </select>
          <div class="explain"></div>
        </td>
        <td><textarea></textarea></td>
      </tr>
      <tr>
        <td>é«”äº’</td>
        <td><input></td>
        <td><input></td>
        <td>
          <select onchange="showExplain(this)">
            <option value="">é¸æ“‡</option>
            <option>WS</option>
            <option>WK</option>
            <option>SS</option>
            <option>SK</option>
            <option>BH</option>
          </select>
          <div class="explain"></div>
        </td>
        <td><textarea></textarea></td>
      </tr>
      <tr>
        <td>ç”¨äº’</td>
        <td><input></td>
        <td><input></td>
        <td>
          <select onchange="showExplain(this)">
            <option value="">é¸æ“‡</option>
            <option>WS</option>
            <option>WK</option>
            <option>SS</option>
            <option>SK</option>
            <option>BH</option>
          </select>
          <div class="explain"></div>
        </td>
        <td><textarea></textarea></td>
      </tr>
      <tr>
        <td>è®Šå¦</td>
        <td><input></td>
        <td><input></td>
        <td>
          <select onchange="showExplain(this)">
            <option value="">é¸æ“‡</option>
            <option>WS</option>
            <option>WK</option>
            <option>SS</option>
            <option>SK</option>
            <option>BH</option>
          </select>
          <div class="explain"></div>
        </td>
        <td><textarea></textarea></td>
      </tr>
    </tbody>
  </table>  <div class="controls">
    <button onclick="saveData()">ğŸ’¾ å„²å­˜</button>
    <button onclick="downloadCSV()">â¬‡ï¸ åŒ¯å‡º CSV</button>
    <button onclick="downloadJSON()">â¬‡ï¸ åŒ¯å‡º JSON</button>
    <button onclick="resetForm()">ğŸ§¹ æ¸…é™¤</button>
  </div>  <div class="summary">
    <h3>ğŸ“Œ åˆ¤æ–·æ‘˜è¦</h3>
    <p><b>ç•¶ä¸‹ç‹€æ…‹ï¼ˆæœ¬å¦ï¼‰ï¼š</b><span id="sum-ben"></span></p>
    <p><b>éç¨‹ï¼ˆé«”äº’/ç”¨äº’ï¼‰ï¼š</b><span id="sum-guo"></span></p>
    <p><b>æœ€çµ‚çµæœï¼ˆè®Šå¦ï¼‰ï¼š</b><span id="sum-bian"></span></p>
    <p><b>æ•´é«”çµè«–ï¼š</b><span id="sum-all"></span></p>
  </div>  <script>
    const table = document.getElementById("records");

    const explainMap = {
      WS: "ç”¨ç”Ÿé«”ï¼Œå¤§å‰ï¼Œæœ‰åŠ©åŠ›ã€‚",
      WK: "ç”¨å…‹é«”ï¼Œå¤§å‡¶ï¼Œå—å£“åˆ¶ã€‚",
      SS: "é«”ç”Ÿç”¨ï¼Œè€—æ³„ï¼Œä»˜å‡ºã€‚",
      SK: "é«”å…‹ç”¨ï¼Œè¾›è‹¦ï¼Œä½†æœ‰æœ›æˆåŠŸã€‚",
      BH: "é«”ç”¨æ¯”å’Œï¼Œå¹³å’Œï¼Œé †åˆ©ã€‚"
    };

    function showExplain(sel) {
      const value = sel.value;
      const explainDiv = sel.parentNode.querySelector(".explain");
      explainDiv.textContent = value ? explainMap[value] : "";
      updateSummary();
    }

    function getData() {
      const rows = [...table.querySelectorAll("tr")];
      return rows.map(r => {
        const inputs = r.querySelectorAll("input, select, textarea");
        return {
          å¦ä½å±¤æ¬¡: r.cells[0].innerText,
          é«”: inputs[0].value,
          ç”¨äº’è®Š: inputs[1].value,
          ä»£è™Ÿ: inputs[2].value,
          åˆ¤æ–·: inputs[3].value
        };
      });
    }

    function generateOverall(data) {
      const parts = data.map(d => d.åˆ¤æ–· || explainMap[d.ä»£è™Ÿ] || d.ä»£è™Ÿ);
      if (parts.every(p => p)) {
        return `æ­¤å¦ä»¥${parts[0]}ç‚ºåŸºï¼Œç•¶ä¸‹${parts[1]}ï¼Œä¸­é€”${parts[2]}ï¼ŒçºŒç¨‹${parts[3]}ï¼Œæœ€å¾Œ${parts[4]}ï¼Œå®œè¬¹æ…é˜²ç¯„ã€‚`;
      } else {
        return "è«‹å®Œæ•´å¡«å¯«é«”ã€ç”¨ã€é«”äº’ã€ç”¨äº’ã€è®Šå¦å¾Œï¼Œè‡ªå‹•ç”Ÿæˆæ•´é«”åˆ¤æ–·ã€‚";
      }
    }

    function saveData() {
      const data = getData();
      localStorage.setItem("meihua", JSON.stringify(data));
      updateSummary();
      alert("å·²å„²å­˜è‡³ç€è¦½å™¨");
    }

    function loadData() {
      const data = JSON.parse(localStorage.getItem("meihua") || "null");
      if (!data) return;
      const rows = [...table.querySelectorAll("tr")];
      data.forEach((d, i) => {
        const inputs = rows[i].querySelectorAll("input, select, textarea");
        inputs[0].value = d.é«”;
        inputs[1].value = d.ç”¨äº’è®Š;
        inputs[2].value = d.ä»£è™Ÿ;
        showExplain(inputs[2]);
        inputs[3].value = d.åˆ¤æ–·;
      });
      updateSummary();
    }

    function resetForm() {
      localStorage.removeItem("meihua");
      [...table.querySelectorAll("input, select, textarea")].forEach(el => el.value = "");
      [...table.querySelectorAll(".explain")].forEach(el => el.textContent = "");
      updateSummary();
    }

    function downloadCSV() {
      const data = getData();
      const header = Object.keys(data[0]).join(",");
      const rows = data.map(d => Object.values(d).map(v => `"${v}"`).join(","));
      const csv = [header, ...rows].join("\n");
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "å å¦ç­†è¨˜.csv";
      link.click();
    }

    function downloadJSON() {
      const data = getData();
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "å å¦ç­†è¨˜.json";
      link.click();
    }

    function updateSummary() {
      const data = getData();
      document.getElementById("sum-ben").innerText = data[0].åˆ¤æ–· || explainMap[data[0].ä»£è™Ÿ] || data[0].ä»£è™Ÿ;
      document.getElementById("sum-guo").innerText =
        (data[1].åˆ¤æ–· || explainMap[data[1].ä»£è™Ÿ] || data[1].ä»£è™Ÿ) + " / " +
        (data[2].åˆ¤æ–· || explainMap[data[2].ä»£è™Ÿ] || data[2].ä»£è™Ÿ);
      document.getElementById("sum-bian").innerText = data[3].åˆ¤æ–· || explainMap[data[3].ä»£è™Ÿ] || data[3].ä»£è™Ÿ;
      document.getElementById("sum-all").innerText = generateOverall([data[0], data[1], data[2], data[3], data[3]]);
    }

    // åˆå§‹åŒ–è¼‰å…¥
    loadData();
    table.addEventListener("input", updateSummary);
  </script></body>
</html>
